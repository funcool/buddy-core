<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Ciphers</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">buddy-core</span> <span class="project-version">1.10.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="00-introduction.html"><div class="inner"><span>Introduction</span></div></a></li><li class="depth-1 "><a href="01-hash.html"><div class="inner"><span>Hash algorithms (digest)</span></div></a></li><li class="depth-1 "><a href="02-mac.html"><div class="inner"><span>MAC algorithms</span></div></a></li><li class="depth-1 "><a href="03-keys.html"><div class="inner"><span>Keys</span></div></a></li><li class="depth-1 "><a href="04-dsa.html"><div class="inner"><span>Digital Signatures</span></div></a></li><li class="depth-1 "><a href="05-kdf.html"><div class="inner"><span>Key Derivation Functions (KDF)</span></div></a></li><li class="depth-1  current"><a href="06-cipher.html"><div class="inner"><span>Ciphers</span></div></a></li><li class="depth-1 "><a href="07-padding.html"><div class="inner"><span>Paddings</span></div></a></li><li class="depth-1 "><a href="08-nonce.html"><div class="inner"><span>Nonces and Salts</span></div></a></li><li class="depth-1 "><a href="09-certificates.html"><div class="inner"><span>Certificates (X.509)</span></div></a></li><li class="depth-1 "><a href="10-utils.html"><div class="inner"><span>Codecs &amp; Bytes</span></div></a></li><li class="depth-1 "><a href="11-faq.html"><div class="inner"><span>FAQ</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>buddy</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></div></li><li class="depth-3 branch"><a href="buddy.core.bytes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bytes</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.certificates.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>certificates</span></div></a></li><li class="depth-3"><a href="buddy.core.codecs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codecs</span></div></a></li><li class="depth-4"><a href="buddy.core.codecs.base64.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>base64</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.crypto.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>crypto</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.dsa.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dsa</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.hash.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hash</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.kdf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kdf</span></div></a></li><li class="depth-3"><a href="buddy.core.keys.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>keys</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jwk</span></div></div></li><li class="depth-5 branch"><a href="buddy.core.keys.jwk.ec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ec</span></div></a></li><li class="depth-5 branch"><a href="buddy.core.keys.jwk.eddsa.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>eddsa</span></div></a></li><li class="depth-5 branch"><a href="buddy.core.keys.jwk.okp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>okp</span></div></a></li><li class="depth-5 branch"><a href="buddy.core.keys.jwk.proto.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proto</span></div></a></li><li class="depth-5"><a href="buddy.core.keys.jwk.rsa.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rsa</span></div></a></li><li class="depth-4"><a href="buddy.core.keys.pem.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>pem</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.mac.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>mac</span></div></a></li><li class="depth-3 branch"><a href="buddy.core.nonce.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nonce</span></div></a></li><li class="depth-3"><a href="buddy.core.padding.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>padding</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -610px;"><span class="top" style="height: 619px;"></span><span class="bottom"></span></span><span>util</span></div></div></li><li class="depth-3 branch"><a href="buddy.util.deflate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deflate</span></div></a></li><li class="depth-3"><a href="buddy.util.ecdsa.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ecdsa</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#ciphers" name="ciphers"></a>Ciphers</h1>
<p>Ciphers support in buddy-core is available on <code>buddy.core.crypto</code> namespace.</p>
<h2><a href="#block-ciphers" name="block-ciphers"></a>Block Ciphers</h2>
<p>In cryptography, a block cipher is a deterministic algorithm operating on fixed-length groups of bits, called blocks, with an unvarying transformation that is specified by a symmetric key.</p>
<p>This is a table of currently supported block ciphers in buddy-core:</p>
<table>
  <thead>
    <tr>
      <th>Algorithm name </th>
      <th>Keywords </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>AES </td>
      <td><code>:aes</code> </td>
    </tr>
    <tr>
      <td>Twofish </td>
      <td><code>:twofish</code> </td>
    </tr>
    <tr>
      <td>Blowfish </td>
      <td><code>:blowfish</code> </td>
    </tr>
  </tbody>
</table>
<p>Additionally, for good security, is mandatory to combine a block cipher with some cipher mode of operation.</p>
<p>This is a table of currently supported of cipher mode of operation:</p>
<table>
  <thead>
    <tr>
      <th>Algorithm name </th>
      <th>Keywords </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SIC (CTR) </td>
      <td><code>:ctr</code>, <code>:sic</code> </td>
    </tr>
    <tr>
      <td>CBC </td>
      <td><code>:cbc</code> </td>
    </tr>
    <tr>
      <td>OFB </td>
      <td><code>:ofb</code> </td>
    </tr>
    <tr>
      <td>GCM </td>
      <td><code>:gcm</code> </td>
    </tr>
  </tbody>
</table>
<p><strong>NOTE</strong>: currently buddy comes with limited number of ciphers and modes, but in near future more many more options should be added.</p>
<p>Example encrypt:</p>
<pre><code class="clojure">(require '[buddy.core.crypto :as crypto])
(require '[buddy.core.nonce :as nonce])
(require '[buddy.core.codecs :as codecs])

(let [eng   (crypto/block-cipher :twofish :cbc)
      iv16  (nonce/random-nonce 16)
      key32 (nonce/random-nonce 32)
      data  (codecs/hex-&gt;bytes "000000000000000000000000000000AA")]
  (crypto/init! eng {:key key32 :iv iv16 :op :encrypt})
  (crypto/process-block! eng data))

;; =&gt; #&lt;byte[] [B@efadff9&gt;
</code></pre>
<p>AEAD mode of operations also exposes additional function for caluclate the total size of the output including the authentication tag: <code>output-size</code>.</p>
<h2><a href="#stream-ciphers" name="stream-ciphers"></a>Stream Ciphers</h2>
<p>Stream ciphers differ from block ciphers, in that they works with arbitrary length input and do not require any additional mode of operation.</p>
<p>This is a table of currently supported of stream ciphers in buddy:</p>
<table>
  <thead>
    <tr>
      <th>Algorithm name </th>
      <th>Keywords </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ChaCha </td>
      <td><code>:chacha</code> </td>
    </tr>
  </tbody>
</table>
<p>Example encrypt:</p>
<pre><code class="clojure">(require '[buddy.core.crypto :as crypto])
(require '[buddy.core.codecs :as codecs])
(require '[buddy.core.nonce :as nonce])

(let [eng   (crypto/stream-cipher :chacha)
      iv8   (nonce/random-nonce 8)
      key32 (nonce/random-nonce 32)
      data  (codecs/hex-&gt;bytes "0011")]
  (crypto/init! eng {:key key32 :iv iv8 :op :encrypt})
  (crypto/process-bytes! eng data))

;; =&gt; #&lt;byte[] [B@efadff9&gt;
</code></pre>
<p><strong>NOTE:</strong> the iv and key size depends estrictly on cipher engine, in this case, chacha engine requires 8 bytes iv.</p>
<p><strong>NOTE:</strong> for decrypt, only change <code>:op</code> value to <code>:decrypt</code></p>
<p><strong>NOTE:</strong> You can call <code>crypto/initialize!</code> any times as you want, it simply reinitializes the engine.</p>
<h2><a href="#high-level-encryption-schemes" name="high-level-encryption-schemes"></a>High level encryption schemes</h2>
<p>Since version 0.6.0, <em>buddy-core</em> comes with high level crypto interface that allows user encrypt arbitrary length data using one of the well established encryption schemes.</p>
<p>The api consists in two simple functions. Let see an example of how to encrypt arbitrary length text and decrypt it:</p>
<pre><code class="clojure">(require '[buddy.core.crypto :as crypto])
(require '[buddy.core.codecs :as codecs])
(require '[buddy.core.nonce :as nonce])
(require '[buddy.core.hash :as hash])

(def original-text
  (codecs/to-bytes "Hello World."))

(def iv (nonce/random-bytes 16))   ;; 16 bytes random iv
(def key (hash/sha256 "mysecret")) ;; 32 bytes key

;; Encrypt the original-text content using previously
;; declared iv and key.
(def encrypted (crypto/encrypt original-text key iv
                               {:alg :aes128-cbc-hmac-sha256}))

;; And now, decrypt it using the same parameters:
(-&gt; (crypto/decrypt encrypted key iv {:alg :aes128-cbc-hmac-sha256})
    (codecs/bytes-&gt;str))
;; =&gt; "Hello World."
</code></pre>
<p>This is a complete list of supported encryption schemes:</p>
<ul>
  <li><code>:aes128-cbc-hmac-sha256</code> (default)</li>
  <li><code>:aes192-cbc-hmac-sha384</code></li>
  <li><code>:aes256-cbc-hmac-sha512</code></li>
  <li><code>:aes128-gcm</code></li>
  <li><code>:aes192-gcm</code></li>
  <li><code>:aes256-gcm</code></li>
</ul></div></div></div></body></html>